<!DOCTYPE>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="public/img/kurento.png" type="image/png" />

    <link rel="stylesheet" href="https://bootswatch.com/readable/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/public/bower_components/demo-console/index.css">
    <link rel="stylesheet" href="/public/bower_components/ekko-lightbox/dist/ekko-lightbox.min.css">
    <link rel="stylesheet" href="/public/css/style.min.css">

    <script src="/public/bower_components/adapter.js/adapter.js"></script>
    <script src="/public/bower_components/jquery/dist/jquery.min.js"></script>
    <script src="/public/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/public/bower_components/demo-console/index.js"></script>
    <script src="/public/bower_components/ekko-lightbox/dist/ekko-lightbox.min.js"></script>

    <script src="/public/bower_components/kurento-utils/js/kurento-utils.js"></script>

    <script src="/public/js/index.js"></script>
    <title>Projet Ynov</title>
</head>
<body>

    <nav class="navbar navbar-default navbar-static-top">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">Projet WebRTC</a>
            </div>

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    {{#if isConnected}}
                        <li>
                            <a href="/account">Account</a>
                        </li>
                        <li>
                            <a href="/login/logout">Logout</a>
                        </li>
                    {{else}}
                        <li>
                            <a href="/login/signup">Signup</a>
                        </li>
                        <li>
                            <a href="#" data-toggle="modal" data-target="#login-modal">Login</a>
                        </li>
                    {{/if}}
                </ul>
            </div>
        </div>
    </nav>

    {{#if messages}}
        {{#each messages}}
            <div class="container">
                <div class="alert alert-info">
                    <strong>Info : </strong> {{this}}
                </div>
            </div>
        {{/each}}
    {{/if}}

    {{#if errors}}
        {{#each errors}}
            <div class="container">
                <div class="alert alert-danger">
                    <strong>Erreur : </strong> {{this}}
                </div>
            </div>
        {{/each}}
    {{/if}}

    <div class="container">
        {{{body}}}
    </div>

    {{#unless isConnected}}
        {{>login}}
    {{/unless}}

    <script src="/socket.io/socket.io.js"></script>
    <script>
        let socket = io();
        $('#formChat').submit(function(){
            socket.emit('chat message', $('.chat_window .message_input').val());
            $('.chat_window .message_input').val('');
            return false;
        });
        socket.on('chat message', function(msg){
            $('.chat_window .messages_chat').append("" +
                    "<li class='message right'>" +
                    "   <div class='avatar'>" +
                    "   </div>" +
                    "   <div class='text_wrapper'>" +
                    "       <div class='text'>" +
                            msg +
                    "       </div>" +
                    "   </div>" +
                    "</li>");
        });
    </script>
</body>
</html>